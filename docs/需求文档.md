# 随手记账 - 产品需求文档

## 项目概述

随手记账是一款简单易用的个人财务管理工具，用户可以记录日常开支和收入，管理账单分类，并查看账单列表与统计数据。

## 功能与页面规格

### 1. 首页（Home）

#### 功能描述

- 展示账单摘要统计信息（总收入、总支出、结余）
- 显示最近账单记录列表
- 提供数据刷新功能

#### 前端功能需求

- **数据处理**：
  - 读取：获取统计摘要数据和最近账单列表
  - 刷新：重新获取统计摘要和最近账单数据

#### 数据需求

- 统计摘要数据：
  - `expense`：总支出金额
  - `income`：总收入金额
  - `balance`：结余金额（收入 - 支出）
- 最近账单数据（与账单列表相同，但只显示最近 5-10 条）

### 2. 账单列表（BillList）

#### 功能描述

- 展示所有账单的列表，包括账单金额、类型、分类、日期和备注
- 支持分页浏览账单
- 提供筛选功能（日期范围、账单类型、分类、关键词）
- 显示筛选结果的统计摘要（收入总额、支出总额）
- 提供编辑和删除操作
- 提供新增账单入口

#### 前端功能需求

- **账单表格**：
  - 表格列：日期、类型、金额、分类、备注、操作
  - 金额根据收入/支出类型显示不同颜色
  - 分页控件：支持页码跳转和每页显示条数调整
  - 操作列：编辑按钮和删除按钮
- **数据处理**：
  - 读取：获取账单列表数据，支持分页和筛选
  - 删除：删除选定的账单记录
  - 跳转：点击编辑按钮跳转到编辑账单页面
  - 新增：点击新增按钮跳转到新增账单页面

#### 数据需求

- 账单数据：
  - 字段：`_id`、`amount`、`type`、`categoryId`、`category`、`date`、`remark`、`createdAt`
  - 分页信息：`current`（当前页码）、`pageSize`（每页条数）、`total`（总条数）
- 分类数据（用于筛选）：
  - 字段：`_id`、`name`、`type`

### 3. 新增/编辑账单（BillForm）

#### 功能描述

- 提供表单，用户可以填写账单信息（金额、类型、分类、日期、备注）
- 支持切换账单类型（收入/支出）
- 根据账单类型显示对应的分类选项
- 支持新增分类的快捷操作
- 编辑模式下自动填充当前账单数据

#### 前端功能需求

- **表单组件**：
  - 账单类型：单选按钮组（收入/支出）
  - 分类选择：下拉选择框，根据当前账单类型动态显示对应分类
  - 分类管理：新增分类按钮，点击后显示分类名称输入框
  - 日期范围选择：日期选择器，默认选择近七天日期，不能选未来
  - 备注输入：多行文本框，可选填
- **数据处理**：
  - 读取：
    - 获取分类列表数据
    - 编辑模式下获取指定账单的详细信息
  - 创建：
    - 创建新账单记录
    - 创建新分类记录（快捷创建）
  - 更新：编辑模式下更新现有账单记录

#### 数据需求

- 分类数据：
  - 字段：`_id`、`name`、`type`
- 账单详情数据（编辑模式）：
  - 字段：`_id`、`amount`、`type`、`categoryId`、`date`、`remark`

### 4. 分类管理（Categories）

#### 功能描述

- 展示按类型（收入/支出）分组的分类列表
- 提供新增、编辑和删除分类的功能
- 支持在不同类型（收入/支出）间切换

#### 前端功能需求

- **数据处理**：
  - 读取：获取所有分类列表数据
  - 创建：通过弹窗创建新分类
  - 更新：通过弹窗编辑现有分类
  - 删除：删除指定分类（需二次确认）

#### 数据需求

- 分类数据：
  - 字段：`_id`、`name`、`type`、`createdAt`

## 数据模型

### 1. 账单（Bill）

```typescript
interface Bill {
  _id?: string; // 账单ID
  amount: number; // 金额
  type: 'expense' | 'income'; // 类型（支出/收入）
  categoryId: string; // 分类ID
  category?: Category; // 分类信息（关联查询时）
  date: Date | string; // 日期
  remark?: string; // 备注
  createdAt?: Date; // 创建时间
  updatedAt?: Date; // 更新时间
}
```

### 2. 分类（Category）

```typescript
interface Category {
  _id?: string; // 分类ID
  name: string; // 分类名称
  type: 'expense' | 'income'; // 类型（支出/收入）
  icon?: string; // 图标（可选）
  createdAt?: Date; // 创建时间
  updatedAt?: Date; // 更新时间
}
```

### 3. 分页（Pagination）

```typescript
interface Pagination {
  current: number; // 当前页码
  pageSize: number; // 每页数量
  total: number; // 总数据条数
}
```

### 4. 查询参数（QueryParams）

```typescript
interface QueryParams {
  page?: number; // 页码
  limit?: number; // 每页数量
  type?: 'expense' | 'income'; // 类型筛选
  categoryId?: string; // 分类筛选
  startDate?: Date | string; // 开始日期
  endDate?: Date | string; // 结束日期
  keyword?: string; // 关键词搜索
}
```


## 技术特性与注意事项

### 前端技术栈

- React + TypeScript
- UmiJS 框架
- Ant Design UI 组件库
- Day.js 处理日期

### 后端接口规范

1. 统一响应格式

   ```typescript
   interface ApiResponse<T> {
    code: string; 
     data?: T; // 响应数据
     msg?: string; // 错误或成功提示信息
   }
   ```

2. 错误处理
   - HTTP 状态码：使用合适的状态码表示不同类型的错误
   - 详细错误信息：在响应中提供明确的错误信息